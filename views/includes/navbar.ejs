<nav class="navbar navbar-expand-lg bg-body-light border-bottom sticky-top">
  <div class="container-fluid">

    <!-- Brand -->
    <a class="navbar-brand" href="/listings">
     ReWear
    </a>

    <!-- Offcanvas Toggle Button -->
    <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
      aria-controls="offcanvasNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Offcanvas for small screens -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title text-danger fw-semibold" id="offcanvasNavbarLabel">Menu</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>

      <div class="offcanvas-body">

        <!-- Left Nav Links -->
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link text-danger fw-semibold" href="/listings">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-danger fw-semibold" href="/listings/new">Sell Your Clothes</a>
          </li>
        </ul>

        <!-- Centered Search Bar (visible on all screen sizes) -->
        <div class="d-flex mx-auto mb-3 mb-lg-0">
          <form class="d-flex rounded-pill shadow-lg overflow-hidden" role="search" id="searchBar" action="/listings" method="get">
            <input class="form-control border-0 px-4 py-2 bg-light text-dark" type="search" placeholder="Search locations..." aria-label="Search" name="q">
            <button class="btn btn-danger px-4" type="submit">Search</button>
          </form>
        </div>
        <!-- Right Auth Buttons & Toggle -->
        <div class="d-flex align-items-center ms-lg-3 flex-column flex-lg-row gap-2">
          <% if (!currUser) { %>
            <a href="/signup" class="btn btn-outline-danger rounded-pill px-3">Sign Up</a>
            <a href="/login" class="btn btn-danger rounded-pill px-3 login_darkmode">Log In</a>
          <% } else { %>
            <a href="/logout" class="btn btn-outline-secondary rounded-pill px-3 login_darkmode">Log Out</a>
          <% } %>

          <!-- Dark Mode Toggle -->
          <div class="form-check form-switch d-flex align-items-center ms-lg-3">
            <input class="form-check-input" type="checkbox" id="darkModeToggle" role="switch">
            <label class="form-check-label ms-2 fw-semibold text-danger" for="darkModeToggle">
              Dark Mode
            </label>
          </div>
        </div>

      </div>
    </div>
  </div>
</nav>

  <script>
  const toggle = document.getElementById('darkModeToggle');
  const body = document.body;
  const navbar = document.querySelector('.navbar');

  // Set initial theme from localStorage
  if (localStorage.getItem('theme') === 'dark') {
    body.classList.add('dark-mode');
    navbar.classList.remove('navbar-light', 'bg-body-light');
    navbar.classList.add('navbar-dark', 'bg-dark');
    toggle.checked = true;
  }

  toggle.addEventListener('change', () => {
    const isDark = body.classList.toggle('dark-mode');

    // Toggle Bootstrap navbar classes
    navbar.classList.toggle('navbar-dark', isDark);
    navbar.classList.toggle('bg-dark', isDark);
    navbar.classList.toggle('navbar-light', !isDark);
    navbar.classList.toggle('bg-body-light', !isDark);

    // Store preference
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  });
</script>
